# Description : Fast and portable software for combinatorial optimization
# URL         : https://developers.google.com/optimization
# Maintainer  : camille, camille at lzr dot pw
# Depends on  : cmake

name=or-tools
_commit=4a0cf8b9e7966cdb213176f8d27c392ad00ab091
version=9.3
release=1
source=("https://github.com/google/$name/archive/$_commit.tar.gz")

build() {
    cd "$name-$_commit"

    mkdir build; cd "$_"

    local -a args

    args=(
        -DBUILD_TYPE=Release
        -DUSE_COINOR=OFF
        -DUSE_SCIP=OFF
        -DBUILD_SAMPLES=OFF
        -DBUILD_EXAMPLES=OFF
        -DCMAKE_INSTALL_PREFIX=/usr
        -DBUILD_absl=ON
    )

    _build_flags() {
        local bool

        prt-get isinst "$1" \
            && bool=OFF     \
            || bool=ON

        args+=("$2=$bool")
    }

    _build_flags re2      -DBUILD_re2
    _build_flags zlib     -DBUILD_ZLIB
    _build_flags eigen    -DBUILD_Eigen3
    _build_flags protobuf -DBUILD_Protobuf

    cmake .. "${args[@]}"

    make
    make DESTDIR="$PKG" install
}
